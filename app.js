!function(e){function n(o){if(t[o])return t[o].exports;var r=t[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}var t={};return n.m=e,n.c=t,n.p="/circles/",n(0)}([function(e,n,t){t(6),t(3)},function(e,n){e.exports=function(){var e={tickLength:20,playerRadius:20,playerMaxSpeed:20,playerAcceleration:.2,outerBoundarySize:8e3,gameLength:4e4,maxLag:1e4};return e.maxTime=e.gameLength/e.tickLength,e.boundarySpeed=e.outerBoundarySize/(4*e.maxTime),e.innerBoundaryStart=e.outerBoundarySize/4,e.centrePoint=e.outerBoundarySize/2,e.getInnerBoundaryPosition=function(n){return e.innerBoundaryStart+n*e.boundarySpeed},e.getOuterBoundaryPosition=function(n){return n*e.boundarySpeed},e.getOuterBoundaryRadius=function(n){return e.centrePoint-n*e.boundarySpeed},e.getInnerBoundaryRadius=function(n){return e.centrePoint-n*e.boundarySpeed-e.innerBoundaryStart},e.getSecondsLeft=function(n){return Math.ceil((1-n/e.maxTime)*e.gameLength/1e3)},e}},function(e,n){e.exports=function(){var e={},n={input:document.getElementById("nameInput"),playButton:document.getElementById("playButton"),startScreen:document.getElementById("startScreen"),message:document.getElementById("message"),leaderboard:document.getElementById("leaderboard"),leaderlist:document.getElementById("leaderlist")},t={threshold:35,inProgress:0,startX:0,startY:0},o={left:!1,right:!1,up:!1,down:!1};e.bindPlayButton=function(e){n.playButton.addEventListener("click",e),n.input.addEventListener("keypress",function(n){13===n.keyCode&&e.call()})},e.bindWindowResize=function(e,n){e(n),window.addEventListener("resize",function(){e(n)})};var r;e.userControlEvents={bindActions:function(e){r=e,a.bindActions(),i.bindActions()},unbindActions:function(){a.unbindActions(),i.unbindActions()}};var i={bindActions:function(){window.addEventListener("touchstart",this.touchStartHandler),window.addEventListener("touchmove",this.touchMoveHandler),window.addEventListener("touchend",this.touchEndHandler)},unbindActions:function(){window.removeEventListener("touchstart",this.touchStartHandler),window.removeEventListener("touchmove",this.touchMoveHandler),window.removeEventListener("touchend",this.touchEndHandler)},touchStartHandler:function(e){if(e.preventDefault(),1===e.touches.length){var n=e.touches[0];n.startX=n.screenX,n.startY=n.screenY}r(o)},touchMoveHandler:function(e){e.preventDefault();var n=e.touches[0].screenX-t.startX,i=e.touches[0].screenY-t.startY;n>t.threshold?o.right=!0:o.right=!1,n<-t.threshold?o.left=!0:o.left=!1,i>t.threshold?o.down=!0:o.down=!1,i<-t.threshold?o.up=!0:o.up=!1,r(o)},touchEndHandler:function(e){e.preventDefault(),0===e.touches.length&&(o={left:!1,right:!1,up:!1,down:!1}),r(o)}},a={bindActions:function(){window.addEventListener("keydown",this.keydownHandler),window.addEventListener("keyup",this.keyupHandler)},unbindActions:function(){window.removeEventListener("keydown",this.keydownHandler),window.removeEventListener("keyup",this.keyupHandler)},keydownHandler:function(e){switch(e.keyCode){case 37:case 65:o.left=!0;break;case 38:case 87:o.up=!0;break;case 39:case 68:o.right=!0;break;case 40:case 83:o.down=!0}r(o)},keyupHandler:function(e){switch(e.keyCode){case 37:case 65:o.left=!1;break;case 38:case 87:o.up=!1;break;case 39:case 68:o.right=!1;break;case 40:case 83:o.down=!1}r(o)}};return e.showStartScreen=function(){n.startScreen.addEventListener("animationend",function(){n.startScreen.className=""},!1),n.startScreen.className="",window.focus()},e.hideStartScreen=function(){n.startScreen.addEventListener("animationend",function(){n.startScreen.className="hidden"},!1),n.startScreen.className="animateHide",window.focus()},e.showStartMessage=function(e){n.message.innerHTML=e},e.updateLeaderboard=function(e,t){if(0===e.length)n.leaderboard.className="hidden";else{n.leaderboard.className="",n.leaderlist.innerHTML="";for(var o,r,i=0;i<e.length;i++)o=document.createElement("li"),r=e[i].name+" ("+e[i].score+")",e[i].id===t&&(o.className="you"),o.appendChild(document.createTextNode(r)),n.leaderlist.appendChild(o)}},e}},function(e,n,t){var o=t(5)();o.init()},function(e,n,t){e.exports=function(e){var n,o,r,i,a={},d=t(1)(),c="#fafafa",s="#1a1a1a",u=20,l=document.getElementById(e),h=l.getContext("2d"),f=document.createElement("canvas"),w=f.getContext("2d"),m=200,p=!0,g={x:0,y:0},y={left:0,right:0,top:0,bottom:0};return a.canvas=l,a.setTime=function(e){o=e},a.currentFrame=function(e,t){h.setTransform(n,0,0,n,0,0),h.translate(-y.left,-y.top),a.clearB(),h.globalCompositeOperation="xor",h.font="200px Montserrat Alternates",h.textBaseline="middle",a.drawTime(p,d.centrePoint),a.drawBoundary(),h.globalCompositeOperation="source-over",a.drawGrid(),h.font="bold 20pt Source Sans Pro",h.textBaseline="alphabetic",h.textAlign="center",h.shadowBlur=1;for(var o,r,i=0;i<e.length;i++)o=e[i],o.id!==t.id&&(r=p===o.inner,a.drawPlayer(o.pos.x,o.pos.y,o.name,r,!1));a.drawPlayer(t.x,t.y,t.name,!0,!0),h.shadowBlur=0},a.clearA=function(){h.setTransform(1,0,0,1,0,0),h.clearRect(0,0,l.width,l.height)},a.clearB=function(){h.clearRect(y.left,y.top,window.innerWidth,window.innerHeight)},a.gridPrerender=function(){w.strokeStyle="#aaa",w.lineWidth=1;var e;for(e=0;e<f.width;e+=m)w.beginPath(),w.moveTo(e,0),w.lineTo(e,f.height),w.closePath(),w.stroke();for(e=0;e<f.height;e+=m)w.beginPath(),w.moveTo(0,e),w.lineTo(f.width,e),w.closePath(),w.stroke()},a.drawGrid=function(){var e=y.left-(y.left+m)%m,n=y.top-(y.top+m)%m;h.drawImage(f,e,n)},a.drawBoundary=function(){h.fillStyle=p?s:c,h.beginPath(),h.arc(d.centrePoint,d.centrePoint,d.getOuterBoundaryRadius(o),0,2*Math.PI),h.arc(d.centrePoint,d.centrePoint,d.getInnerBoundaryRadius(o),0,2*Math.PI,!0),h.fill()},a.drawTime=function(){h.fillStyle=p?s:c,h.fillText(d.getSecondsLeft(o),d.centrePoint,d.centrePoint)},a.drawCircle=function(e,n,t,o){void 0!==o&&(h.fillStyle=o),h.beginPath(),h.arc(e,n,t,0,2*Math.PI,!0),h.closePath(),h.fill()},a.drawPlayer=function(e,n,t,o,r){var i=r?"#5599BB":o?s:c;h.shadowColor=r?"transparent":o?c:s,a.drawCircle(e,n,u,i),h.fillText(t,e,n-32)},a.resize=function(e){var t=window.devicePixelRatio||1,o=h.webkitBackingStorePixelRatio||h.mozBackingStorePixelRatio||h.msBackingStorePixelRatio||h.oBackingStorePixelRatio||h.backingStorePixelRatio||1;n=t/o,r=window.innerWidth,i=window.innerHeight,l.width=r*n,l.height=i*n,l.style.width=r+"px",l.style.height=i+"px",f.width=(r+m)*n,f.height=(i+m)*n,a.gridPrerender(),g.x=r/2,g.y=i/2,e.call()},a.swapColours=function(){p=!p;var e=p?c:s;document.body.style.backgroundColor=e},a.setView=function(e){y.left=e.x-g.x,y.top=e.y-g.y,y.right=e.x+g.x,y.bottom=e.y+g.y},a}},function(e,n,t){e.exports=function(){var e,n,o,r={},i=t(4)("canvas"),a=t(2)(),d=t(1)(),c={name:void 0,id:void 0},s=[];r.init=function(){a.bindPlayButton(r.begin),a.bindWindowResize(i.resize,function(){e?i.currentFrame(s,c):i.clearA()})},r.begin=function(){var e=/^\w*$/,n=document.getElementById("nameInput").value;if(e.test(n)){var t=window.navigator.platform.toUpperCase().indexOf("MAC")>=0;t&&(n+="IsADick"),c.name=n||"anon",r.server.connect()}else a.showStartMessage("nickname must be alphanumeric")};var u;return r.server={connect:function(){try{u=io("http://circles-nerdycouple.rhcloud.com:8000",{reconnection:!1}),a.showStartMessage("connecting..."),u.on("connect",function(){a.showStartMessage("connected"),c.id="/#"+u.id,u.emit("nick",c)}),u.on("ready",function(){r.startForRealz()}),u.on("update",function(e,n){s=e,i.setTime(n),r.setViewAndPlayer()}),u.on("endRound",function(e){a.updateLeaderboard(e),i.swapColours()}),u.on("kick",function(e){o=e}),u.on("ping",function(e){u.emit("pong",e)}),u.on("disconnect",function(){r.end()})}catch(e){e instanceof ReferenceError?a.showStartMessage("server is down :("):a.showStartMessage("I have no idea what went wrong ¯\\_(ツ)_/¯")}},update:function(e){u.emit("update",e)}},r.physics=function(){var e,t,o=window.performance.now(),r=o-n;e=r/d.tickLength;for(var a=0;a<s.length;a++)t=s[a],t.pos.x+=t.vel.x*e,t.pos.y+=t.vel.y*e,t.id===c.id&&(c.x=t.pos.x,c.y=t.pos.y);i.setView(c),n=o},r.startForRealz=function(){var t=function(){e=window.requestAnimationFrame(t),i.currentFrame(s,c),r.physics()};n=window.performance.now(),a.hideStartScreen(),a.userControlEvents.bindActions(r.server.update),t()},r.end=function(){window.cancelAnimationFrame(e),i.clearA(),a.showStartScreen(),a.userControlEvents.unbindActions(),a.showStartMessage(o),document.body.style.backgroundColor=i.white},r.setViewAndPlayer=function(){var e=s.find(function(e){return e.id===c.id});null!=e&&(c.x=e.pos.x,c.y=e.pos.y,i.setView(c))},r}},function(e,n){}]);