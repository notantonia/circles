!function(e){function n(o){if(t[o])return t[o].exports;var i=t[o]={exports:{},id:o,loaded:!1};return e[o].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var t={};return n.m=e,n.c=t,n.p="/circles/",n(0)}([function(e,n,t){t(6),t(3)},function(e,n){e.exports=function(){var e={tickLength:20,playerRadius:20,playerMaxSpeed:20,playerAcceleration:.2,outerBoundarySize:8e3,gameLength:4e4,maxLag:1e4};return e.maxTime=e.gameLength/e.tickLength,e.boundarySpeed=e.outerBoundarySize/(4*e.maxTime),e.innerBoundaryStart=e.outerBoundarySize/4,e.centrePoint=e.outerBoundarySize/2,e.getInnerBoundaryPosition=function(n){return e.innerBoundaryStart+n*e.boundarySpeed},e.getOuterBoundaryPosition=function(n){return n*e.boundarySpeed},e.getOuterBoundaryRadius=function(n){return e.centrePoint-n*e.boundarySpeed},e.getInnerBoundaryRadius=function(n){return e.centrePoint-n*e.boundarySpeed-e.innerBoundaryStart},e.getSecondsLeft=function(n){return Math.ceil((1-n/e.maxTime)*e.gameLength/1e3)},e.getExplosionRadius=function(e){return 12*e},e}},function(e,n){e.exports=function(){var e={},n={input:document.getElementById("nameInput"),playButton:document.getElementById("playButton"),startScreen:document.getElementById("startScreen"),message:document.getElementById("message"),leaderboard:document.getElementById("leaderboard"),leaderlist:document.getElementById("leaderlist")},t={threshold:35,inProgress:0,startX:0,startY:0},o={left:!1,right:!1,up:!1,down:!1};e.bindPlayButton=function(e){n.playButton.addEventListener("click",e),n.input.addEventListener("keypress",function(n){13===n.keyCode&&e.call()})},e.bindWindowResize=function(e,n){e(n),window.addEventListener("resize",function(){e(n)})};var i;e.userControlEvents={bindActions:function(e){i=e,a.bindActions(),r.bindActions()},unbindActions:function(){a.unbindActions(),r.unbindActions()}};var r={bindActions:function(){window.addEventListener("touchstart",this.touchStartHandler),window.addEventListener("touchmove",this.touchMoveHandler),window.addEventListener("touchend",this.touchEndHandler)},unbindActions:function(){window.removeEventListener("touchstart",this.touchStartHandler),window.removeEventListener("touchmove",this.touchMoveHandler),window.removeEventListener("touchend",this.touchEndHandler)},touchStartHandler:function(e){if(e.preventDefault(),1===e.touches.length){var n=e.touches[0];n.startX=n.screenX,n.startY=n.screenY}i(o)},touchMoveHandler:function(e){e.preventDefault();var n=e.touches[0].screenX-t.startX,r=e.touches[0].screenY-t.startY;n>t.threshold?o.right=!0:o.right=!1,n<-t.threshold?o.left=!0:o.left=!1,r>t.threshold?o.down=!0:o.down=!1,r<-t.threshold?o.up=!0:o.up=!1,i(o)},touchEndHandler:function(e){e.preventDefault(),0===e.touches.length&&(o={left:!1,right:!1,up:!1,down:!1}),i(o)}},a={bindActions:function(){window.addEventListener("keydown",this.keydownHandler),window.addEventListener("keyup",this.keyupHandler)},unbindActions:function(){window.removeEventListener("keydown",this.keydownHandler),window.removeEventListener("keyup",this.keyupHandler)},keydownHandler:function(e){if(!e.repeat){switch(e.keyCode){case 37:case 65:o.left=!0;break;case 38:case 87:o.up=!0;break;case 39:case 68:o.right=!0;break;case 40:case 83:o.down=!0}i(o)}},keyupHandler:function(e){switch(e.keyCode){case 37:case 65:o.left=!1;break;case 38:case 87:o.up=!1;break;case 39:case 68:o.right=!1;break;case 40:case 83:o.down=!1}i(o)}};return e.showStartScreen=function(){n.startScreen.addEventListener("animationend",function(){n.startScreen.className=""},!1),n.startScreen.className="",window.focus()},e.hideStartScreen=function(){n.startScreen.addEventListener("animationend",function(){n.startScreen.className="hidden"},!1),n.startScreen.className="animateHide",window.focus()},e.showStartMessage=function(e){n.message.innerHTML=e},e.updateLeaderboard=function(e,t){if(0===e.length)n.leaderboard.className="hidden";else{n.leaderboard.className="",n.leaderlist.innerHTML="";for(var o,i,r=0;r<e.length;r++)o=document.createElement("li"),i=e[r].name+" ("+e[r].score+")",e[r].id===t&&(o.className="you"),o.appendChild(document.createTextNode(i)),n.leaderlist.appendChild(o)}},e}},function(e,n,t){var o=t(5)();o.init()},function(e,n,t){e.exports=function(e){var n,o,i={},r=t(1)(),a="#fafafa",c="#1a1a1a",d="bold 20pt Source Sans Pro",s=200,u=document.getElementById(e),l=u.getContext("2d"),f=document.createElement("canvas"),h=f.getContext("2d"),m=!0,p={left:0,right:0,top:0,bottom:0,centreX:0,centreY:0};i.canvas=u,i.setTime=function(e){o=e},i.incTime=function(e){o+=e},i.currentFrame=function(e,t){l.setTransform(n,0,0,n,0,0),l.translate(-p.left,-p.top),g(),l.globalCompositeOperation="xor",l.textAlign="center",l.font="200px Montserrat Alternates",l.textBaseline="middle",S(m,r.centrePoint),v(),l.globalCompositeOperation="source-over",y(),x(),w(e,t)};var w=function(e,n){l.font=d,l.textBaseline="alphabetic";for(var t,o,i=0;i<e.length;i++)t=e[i],t.id!==n.id&&(o=m===t.inner,B(t.pos.x,t.pos.y,t.name,o))};i.clearA=function(){l.setTransform(1,0,0,1,0,0),l.clearRect(0,0,u.width,u.height)};var g=function(){l.clearRect(p.left,p.top,window.innerWidth,window.innerHeight)},y=function(){var e=p.left-(p.left+s+.5)%s,n=p.top-(p.top+s+.5)%s;e=(0|e)+.5,n=(0|n)+.5,l.strokeStyle="#aaa",l.lineWidth=1;var t;for(l.beginPath(),t=e;t<p.right;t+=s)l.moveTo(t,p.top),l.lineTo(t,p.bottom);for(t=n;t<p.bottom;t+=s)l.moveTo(p.left,t),l.lineTo(p.right,t);l.stroke()},v=function(){l.fillStyle=m?c:a,l.beginPath(),l.arc(r.centrePoint,r.centrePoint,r.getOuterBoundaryRadius(o),0,2*Math.PI),l.arc(r.centrePoint,r.centrePoint,r.getInnerBoundaryRadius(o),0,2*Math.PI,!0),l.fill()},S=function(){l.fillStyle=m?c:a,l.fillText(r.getSecondsLeft(o),r.centrePoint,r.centrePoint)},b=150,x=function(){var e=r.getExplosionRadius(o),n=r.getOuterBoundaryRadius(o),t=Math.max(e-b,0),i=Math.min(e,n);if(t<=n){var a=l.createRadialGradient(r.centrePoint,r.centrePoint,i,r.centrePoint,r.centrePoint,t);a.addColorStop(1,"transparent"),a.addColorStop(0,"#aaa"),l.fillStyle=a,l.beginPath(),l.arc(r.centrePoint,r.centrePoint,i,0,2*Math.PI,!0),l.arc(r.centrePoint,r.centrePoint,t,0,2*Math.PI,!1),l.closePath(),l.fill()}},P=function(e,n,t,o){void 0!==o&&(h.fillStyle=o),h.beginPath(),h.arc(e,n,t,0,2*Math.PI,!0),h.closePath(),h.fill()},k=r.playerRadius+1,E=function(){f.width=4*k*n,f.height=2*k*n,P(k,k,k-1,c),P(3*k,k,k-1,a)},B=function(e,n,t,o){var i;o?(i=0,l.fillStyle=c):(i=2*k,l.fillStyle=a),l.drawImage(f,i,0,2*k,2*k,e-k,n-k,2*k,2*k),l.fillText(t,e,n-32)},L=document.getElementById("myName"),M=document.getElementById("me");return i.showMe=function(e){L.innerHTML=e.name,M.className=""},i.hideMe=function(){M.className="hidden"},i.resize=function(e){var t=window.devicePixelRatio||1,o=l.webkitBackingStorePixelRatio||l.mozBackingStorePixelRatio||l.msBackingStorePixelRatio||l.oBackingStorePixelRatio||l.backingStorePixelRatio||1,i=window.innerWidth,r=window.innerHeight;n=t/o,u.width=i*n,u.height=r*n,u.style.width=i+"px",u.style.height=r+"px",E(),p.centreX=i/2,p.centreY=r/2,e()},i.swapColours=function(){m=!m;var e=m?a:c;document.body.style.backgroundColor=e},i.setView=function(e){p.left=e.x-p.centreX,p.top=e.y-p.centreY,p.right=e.x+p.centreX,p.bottom=e.y+p.centreY},i}},function(e,n,t){e.exports=function(){var e,n,o,i={},r=t(4)("canvas"),a=t(2)(),c=t(1)(),d={name:void 0,id:void 0},s=[];i.init=function(){a.bindPlayButton(i.begin),a.bindWindowResize(r.resize,function(){e?r.currentFrame(s,d):r.clearA()})},i.begin=function(){var e=/^\w*$/,n=document.getElementById("nameInput").value;if(e.test(n)){var t=window.navigator.platform.toUpperCase().indexOf("MAC")>=0;t&&(n+="IsADick"),d.name=n||"anon",i.server.connect()}else a.showStartMessage("nickname must be alphanumeric")};var u;return i.server={connect:function(){try{u=io("http://circles-nerdycouple.rhcloud.com:8000",{reconnection:!1}),a.showStartMessage("connecting..."),u.on("connect",function(){a.showStartMessage("connected"),d.id="/#"+u.id,u.emit("nick",d)}),u.on("ready",function(){i.startForRealz()}),u.on("update",function(e,n){s=e,r.setTime(n),i.setViewAndPlayer()}),u.on("endRound",function(e){a.updateLeaderboard(e),r.swapColours()}),u.on("kick",function(e){o=e}),u.on("ping",function(e){u.emit("pong",e)}),u.on("disconnect",function(){i.end()})}catch(e){e instanceof ReferenceError?a.showStartMessage("server is down :("):a.showStartMessage("I have no idea what went wrong ¯\\_(ツ)_/¯")}},update:function(e){u.emit("update",e)}},i.physics=function(){var e,t,o=window.performance.now(),i=o-n;e=i/c.tickLength;for(var a=0;a<s.length;a++)t=s[a],t.pos.x+=t.vel.x*e,t.pos.y+=t.vel.y*e,t.id===d.id&&(d.x=t.pos.x,d.y=t.pos.y);r.setView(d),r.incTime(e),n=o},i.startForRealz=function(){var t=function(){r.currentFrame(s,d),i.physics(),setTimeout(function(){e=window.requestAnimationFrame(t)},0)};n=window.performance.now(),a.hideStartScreen(),a.userControlEvents.bindActions(i.server.update),r.showMe(d),t()},i.end=function(){window.cancelAnimationFrame(e),r.clearA(),r.hideMe(d),a.showStartScreen(),a.userControlEvents.unbindActions(),a.showStartMessage(o),document.body.style.backgroundColor=r.white},i.setViewAndPlayer=function(){var e=s.find(function(e){return e.id===d.id});null!=e&&(d.x=e.pos.x,d.y=e.pos.y,r.setView(d))},i}},function(e,n){}]);