!function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return e[o].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="/circles/",t(0)}([function(e,t,n){n(6),n(3)},function(e,t){e.exports=function(){var e={tickLength:20,playerRadius:20,playerMaxSpeed:20,playerAcceleration:.2,outerBoundarySize:8e3,gameLength:4e4,maxLag:1e4};return e.maxTime=e.gameLength/e.tickLength,e.boundarySpeed=e.outerBoundarySize/(4*e.maxTime),e.innerBoundaryStart=e.outerBoundarySize/4,e.centrePoint=e.outerBoundarySize/2,e.getInnerBoundaryPosition=function(t){return e.innerBoundaryStart+t*e.boundarySpeed},e.getOuterBoundaryPosition=function(t){return t*e.boundarySpeed},e.getOuterBoundaryRadius=function(t){return e.centrePoint-t*e.boundarySpeed},e.getInnerBoundaryRadius=function(t){return e.centrePoint-t*e.boundarySpeed-e.innerBoundaryStart},e.getSecondsLeft=function(t){return Math.ceil((1-t/e.maxTime)*e.gameLength/1e3)},e.getExplosionRadius=function(e){return 12*e},e}},function(e,t){e.exports=function(){var e={},t={input:document.getElementById("nameInput"),playButton:document.getElementById("playButton"),startScreen:document.getElementById("startScreen"),message:document.getElementById("message"),leaderboard:document.getElementById("leaderboard"),leaderlist:document.getElementById("leaderlist")},n={threshold:35,inProgress:0,startX:0,startY:0},o={left:!1,right:!1,up:!1,down:!1};e.bindPlayButton=function(e){t.playButton.addEventListener("click",e),t.input.addEventListener("keypress",function(t){13===t.keyCode&&e.call()})},e.bindWindowResize=function(e,t){e(t),window.addEventListener("resize",function(){e(t)})};var i;e.userControlEvents={bindActions:function(e){i=e,a.bindActions(),r.bindActions()},unbindActions:function(){a.unbindActions(),r.unbindActions()}};var r={bindActions:function(){window.addEventListener("touchstart",this.touchStartHandler),window.addEventListener("touchmove",this.touchMoveHandler),window.addEventListener("touchend",this.touchEndHandler)},unbindActions:function(){window.removeEventListener("touchstart",this.touchStartHandler),window.removeEventListener("touchmove",this.touchMoveHandler),window.removeEventListener("touchend",this.touchEndHandler)},touchStartHandler:function(e){if(e.preventDefault(),1===e.touches.length){var t=e.touches[0];t.startX=t.screenX,t.startY=t.screenY}i(o)},touchMoveHandler:function(e){e.preventDefault();var t=e.touches[0].screenX-n.startX,r=e.touches[0].screenY-n.startY;t>n.threshold?o.right=!0:o.right=!1,t<-n.threshold?o.left=!0:o.left=!1,r>n.threshold?o.down=!0:o.down=!1,r<-n.threshold?o.up=!0:o.up=!1,i(o)},touchEndHandler:function(e){e.preventDefault(),0===e.touches.length&&(o={left:!1,right:!1,up:!1,down:!1}),i(o)}},a={bindActions:function(){window.addEventListener("keydown",this.keydownHandler),window.addEventListener("keyup",this.keyupHandler)},unbindActions:function(){window.removeEventListener("keydown",this.keydownHandler),window.removeEventListener("keyup",this.keyupHandler)},keydownHandler:function(e){switch(e.keyCode){case 37:case 65:o.left=!0;break;case 38:case 87:o.up=!0;break;case 39:case 68:o.right=!0;break;case 40:case 83:o.down=!0}i(o)},keyupHandler:function(e){switch(e.keyCode){case 37:case 65:o.left=!1;break;case 38:case 87:o.up=!1;break;case 39:case 68:o.right=!1;break;case 40:case 83:o.down=!1}i(o)}};return e.showStartScreen=function(){t.startScreen.addEventListener("animationend",function(){t.startScreen.className=""},!1),t.startScreen.className="",window.focus()},e.hideStartScreen=function(){t.startScreen.addEventListener("animationend",function(){t.startScreen.className="hidden"},!1),t.startScreen.className="animateHide",window.focus()},e.showStartMessage=function(e){t.message.innerHTML=e},e.updateLeaderboard=function(e,n){if(0===e.length)t.leaderboard.className="hidden";else{t.leaderboard.className="",t.leaderlist.innerHTML="";for(var o,i,r=0;r<e.length;r++)o=document.createElement("li"),i=e[r].name+" ("+e[r].score+")",e[r].id===n&&(o.className="you"),o.appendChild(document.createTextNode(i)),t.leaderlist.appendChild(o)}},e}},function(e,t,n){var o=n(5)();o.init()},function(e,t,n){e.exports=function(e){var t,o,i,r,a={},c=n(1)(),d="#fafafa",s="#1a1a1a",u="#5599BB",l="bold 20pt Source Sans Pro",h=document.getElementById(e),f=h.getContext("2d"),m=document.createElement("canvas"),w=m.getContext("2d"),p=document.createElement("canvas"),g=p.getContext("2d"),y=200,v=!0,S={x:0,y:0},b={left:0,right:0,top:0,bottom:0};a.canvas=h,a.setTime=function(e){o=e},a.currentFrame=function(e,n){f.setTransform(t,0,0,t,0,0),f.translate(-b.left,-b.top),P(),f.globalCompositeOperation="xor",f.font="200px Montserrat Alternates",f.textBaseline="middle",L(v,c.centrePoint),E(),f.globalCompositeOperation="source-over",B(),R(),x(e,n)};var x=function(e,t){f.font=l,f.textBaseline="alphabetic",f.textAlign="center",f.shadowBlur=1;for(var n,o,i=0;i<e.length;i++)n=e[i],n.id!==t.id&&(o=v===n.inner,H(n.pos.x,n.pos.y,n.name,o,!1));H(t.x,t.y,t.name,!0,!0),f.shadowBlur=0};a.clearA=function(){f.setTransform(1,0,0,1,0,0),f.clearRect(0,0,h.width,h.height)};var P=function(){f.clearRect(b.left,b.top,window.innerWidth,window.innerHeight)},k=function(){w.strokeStyle="#aaa",w.lineWidth=1;var e;for(w.beginPath(),e=0;e<m.width;e+=y)w.moveTo(e,0),w.lineTo(e,m.height);for(e=0;e<m.height;e+=y)w.moveTo(0,e),w.lineTo(m.width,e);w.stroke()},B=function(){var e=b.left-(b.left+y)%y,t=b.top-(b.top+y)%y;f.drawImage(m,e,t)},E=function(){f.fillStyle=v?s:d,f.beginPath(),f.arc(c.centrePoint,c.centrePoint,c.getOuterBoundaryRadius(o),0,2*Math.PI),f.arc(c.centrePoint,c.centrePoint,c.getInnerBoundaryRadius(o),0,2*Math.PI,!0),f.fill()},L=function(){f.fillStyle=v?s:d,f.fillText(c.getSecondsLeft(o),c.centrePoint,c.centrePoint)},A=150,R=function(){var e=c.getExplosionRadius(o),t=c.getOuterBoundaryRadius(o);if(e-A<=t){var n=f.createRadialGradient(c.centrePoint,c.centrePoint,Math.min(e,t),c.centrePoint,c.centrePoint,Math.max(e-A,0));n.addColorStop(1,"transparent"),n.addColorStop(0,"#aaa"),f.fillStyle=n,f.beginPath(),f.arc(c.centrePoint,c.centrePoint,Math.min(e,t),0,2*Math.PI,!0),f.closePath(),f.fill()}},M=function(e,t,n,o){void 0!==o&&(g.fillStyle=o),g.beginPath(),g.arc(e,t,n,0,2*Math.PI,!0),g.closePath(),g.fill()},C=c.playerRadius+1,I=function(){p.width=6*C*t,p.height=2*C*t,M(C,C,C-1,s),M(3*C,C,C-1,d),M(5*C,C,C-1,u)},H=function(e,t,n,o,i){var r=i?4*C:o?0:2*C;f.drawImage(p,r,0,2*C,2*C,e-C,t-C,2*C,2*C),f.fillStyle=i?u:o?s:d,f.shadowColor=i?"transparent":o?d:s,f.fillText(n,e,t-32)};return a.resize=function(e){var n=window.devicePixelRatio||1,o=f.webkitBackingStorePixelRatio||f.mozBackingStorePixelRatio||f.msBackingStorePixelRatio||f.oBackingStorePixelRatio||f.backingStorePixelRatio||1;t=n/o,i=window.innerWidth,r=window.innerHeight,h.width=i*t,h.height=r*t,h.style.width=i+"px",h.style.height=r+"px",m.width=(i+y)*t,m.height=(r+y)*t,k(),I(),S.x=i/2,S.y=r/2,e.call()},a.swapColours=function(){v=!v;var e=v?d:s;document.body.style.backgroundColor=e},a.setView=function(e){b.left=e.x-S.x,b.top=e.y-S.y,b.right=e.x+S.x,b.bottom=e.y+S.y},a}},function(e,t,n){e.exports=function(){var e,t,o,i={},r=n(4)("canvas"),a=n(2)(),c=n(1)(),d={name:void 0,id:void 0},s=[];i.init=function(){a.bindPlayButton(i.begin),a.bindWindowResize(r.resize,function(){e?r.currentFrame(s,d):r.clearA()})},i.begin=function(){var e=/^\w*$/,t=document.getElementById("nameInput").value;if(e.test(t)){var n=window.navigator.platform.toUpperCase().indexOf("MAC")>=0;n&&(t+="IsADick"),d.name=t||"anon",i.server.connect()}else a.showStartMessage("nickname must be alphanumeric")};var u;return i.server={connect:function(){try{u=io("http://circles-nerdycouple.rhcloud.com:8000",{reconnection:!1}),a.showStartMessage("connecting..."),u.on("connect",function(){a.showStartMessage("connected"),d.id="/#"+u.id,u.emit("nick",d)}),u.on("ready",function(){i.startForRealz()}),u.on("update",function(e,t){s=e,r.setTime(t),i.setViewAndPlayer()}),u.on("endRound",function(e){a.updateLeaderboard(e),r.swapColours()}),u.on("kick",function(e){o=e}),u.on("ping",function(e){u.emit("pong",e)}),u.on("disconnect",function(){i.end()})}catch(e){e instanceof ReferenceError?a.showStartMessage("server is down :("):a.showStartMessage("I have no idea what went wrong ¯\\_(ツ)_/¯")}},update:function(e){u.emit("update",e)}},i.physics=function(){var e,n,o=window.performance.now(),i=o-t;e=i/c.tickLength;for(var a=0;a<s.length;a++)n=s[a],n.pos.x+=n.vel.x*e,n.pos.y+=n.vel.y*e,n.id===d.id&&(d.x=n.pos.x,d.y=n.pos.y);r.setView(d),t=o},i.startForRealz=function(){var n=function(){e=window.requestAnimationFrame(n),r.currentFrame(s,d),i.physics()};t=window.performance.now(),a.hideStartScreen(),a.userControlEvents.bindActions(i.server.update),n()},i.end=function(){window.cancelAnimationFrame(e),r.clearA(),a.showStartScreen(),a.userControlEvents.unbindActions(),a.showStartMessage(o),document.body.style.backgroundColor=r.white},i.setViewAndPlayer=function(){var e=s.find(function(e){return e.id===d.id});null!=e&&(d.x=e.pos.x,d.y=e.pos.y,r.setView(d))},i}},function(e,t){}]);