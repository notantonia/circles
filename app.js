!function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return e[o].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="/circles/",t(0)}([function(e,t,n){n(6),n(3)},function(e,t){e.exports=function(){var e={tickLength:20,playerRadius:20,playerMaxSpeed:20,playerAcceleration:.2,outerBoundarySize:8e3,gameLength:4e4,maxLag:1e4};return e.maxTime=e.gameLength/e.tickLength,e.boundarySpeed=e.outerBoundarySize/(4*e.maxTime),e.innerBoundaryStart=e.outerBoundarySize/4,e.centrePoint=e.outerBoundarySize/2,e.getInnerBoundaryPosition=function(t){return e.innerBoundaryStart+t*e.boundarySpeed},e.getOuterBoundaryPosition=function(t){return t*e.boundarySpeed},e.getOuterBoundaryRadius=function(t){return e.centrePoint-t*e.boundarySpeed},e.getInnerBoundaryRadius=function(t){return e.centrePoint-t*e.boundarySpeed-e.innerBoundaryStart},e.getSecondsLeft=function(t){return Math.ceil((1-t/e.maxTime)*e.gameLength/1e3)},e.getExplosionRadius=function(e){return 12*e},e}},function(e,t){e.exports=function(){var e={},t={input:document.getElementById("nameInput"),playButton:document.getElementById("playButton"),startScreen:document.getElementById("startScreen"),message:document.getElementById("message"),leaderboard:document.getElementById("leaderboard"),leaderlist:document.getElementById("leaderlist")},n={threshold:35,inProgress:0,startX:0,startY:0},o={left:!1,right:!1,up:!1,down:!1};e.bindPlayButton=function(e){t.playButton.addEventListener("click",e),t.input.addEventListener("keypress",function(t){13===t.keyCode&&e.call()})},e.bindWindowResize=function(e,t){e(t),window.addEventListener("resize",function(){e(t)})};var i;e.userControlEvents={bindActions:function(e){i=e,a.bindActions(),r.bindActions()},unbindActions:function(){a.unbindActions(),r.unbindActions()}};var r={bindActions:function(){window.addEventListener("touchstart",this.touchStartHandler),window.addEventListener("touchmove",this.touchMoveHandler),window.addEventListener("touchend",this.touchEndHandler)},unbindActions:function(){window.removeEventListener("touchstart",this.touchStartHandler),window.removeEventListener("touchmove",this.touchMoveHandler),window.removeEventListener("touchend",this.touchEndHandler)},touchStartHandler:function(e){if(e.preventDefault(),1===e.touches.length){var t=e.touches[0];t.startX=t.screenX,t.startY=t.screenY}i(o)},touchMoveHandler:function(e){e.preventDefault();var t=e.touches[0].screenX-n.startX,r=e.touches[0].screenY-n.startY;t>n.threshold?o.right=!0:o.right=!1,t<-n.threshold?o.left=!0:o.left=!1,r>n.threshold?o.down=!0:o.down=!1,r<-n.threshold?o.up=!0:o.up=!1,i(o)},touchEndHandler:function(e){e.preventDefault(),0===e.touches.length&&(o={left:!1,right:!1,up:!1,down:!1}),i(o)}},a={bindActions:function(){window.addEventListener("keydown",this.keydownHandler),window.addEventListener("keyup",this.keyupHandler)},unbindActions:function(){window.removeEventListener("keydown",this.keydownHandler),window.removeEventListener("keyup",this.keyupHandler)},keydownHandler:function(e){if(!e.repeat){switch(e.keyCode){case 37:case 65:o.left=!0;break;case 38:case 87:o.up=!0;break;case 39:case 68:o.right=!0;break;case 40:case 83:o.down=!0}i(o)}},keyupHandler:function(e){switch(e.keyCode){case 37:case 65:o.left=!1;break;case 38:case 87:o.up=!1;break;case 39:case 68:o.right=!1;break;case 40:case 83:o.down=!1}i(o)}};return e.setup=function(t){e.hideStartScreen(),e.userControlEvents.bindActions(t)},e.reset=function(t){e.showStartScreen(),e.userControlEvents.unbindActions(),null!=t&&e.showStartMessage(t)},e.showStartScreen=function(){t.startScreen.addEventListener("animationend",function(){t.startScreen.className=""},!1),t.startScreen.className="",window.focus()},e.hideStartScreen=function(){t.startScreen.addEventListener("animationend",function(){t.startScreen.className="hidden"},!1),t.startScreen.className="animateHide",window.focus()},e.showStartMessage=function(e){t.message.innerHTML=e},e.updateLeaderboard=function(e,n){if(0===e.length)t.leaderboard.className="hidden";else{t.leaderboard.className="",t.leaderlist.innerHTML="";for(var o,i,r=0;r<e.length;r++)o=document.createElement("li"),i=e[r].name+" ("+e[r].score+")",e[r].id===n&&(o.className="you"),o.appendChild(document.createTextNode(i)),t.leaderlist.appendChild(o)}},e}},function(e,t,n){var o=n(5)();o.init()},function(e,t,n){e.exports=function(e){var t,o,i={},r=n(1)(),a="#fafafa",c="#1a1a1a",d="bold 20pt Source Sans Pro",s="200px Montserrat Alternates",u=200,l=document.getElementById(e),f=l.getContext("2d"),h=document.createElement("canvas"),m=h.getContext("2d"),p=!0,w={left:0,right:0,top:0,bottom:0,centreX:0,centreY:0};i.canvas=l,i.setTime=function(e){o=e},i.incTime=function(e){o+=e},i.reset=function(){f.setTransform(1,0,0,1,0,0),f.clearRect(0,0,l.width,l.height),document.body.style.backgroundColor=a,i.hideMe()},i.currentFrame=function(e,n){f.setTransform(t,0,0,t,0,0),f.translate(-w.left,-w.top),g(),f.globalCompositeOperation="xor",f.textAlign="center",f.font=s,f.textBaseline="middle",b(p,r.centrePoint),S(),f.globalCompositeOperation="source-over",v(),P(),y(e,n)};var y=function(e,t){f.font=d,f.textBaseline="alphabetic";for(var n,o,i=0;i<e.length;i++)n=e[i],n.id!==t.id&&(o=p===n.inner,L(n.pos.x,n.pos.y,n.name,o))},g=function(){f.clearRect(w.left,w.top,window.innerWidth,window.innerHeight)},v=function(){var e=w.left-(w.left+u+.5)%u,t=w.top-(w.top+u+.5)%u;e=(0|e)+.5,t=(0|t)+.5,f.strokeStyle="#aaa",f.lineWidth=1;var n;for(f.beginPath(),n=e;n<w.right;n+=u)f.moveTo(n,w.top),f.lineTo(n,w.bottom);for(n=t;n<w.bottom;n+=u)f.moveTo(w.left,n),f.lineTo(w.right,n);f.stroke()},S=function(){f.fillStyle=p?c:a,f.beginPath(),f.arc(r.centrePoint,r.centrePoint,r.getOuterBoundaryRadius(o),0,2*Math.PI),f.arc(r.centrePoint,r.centrePoint,r.getInnerBoundaryRadius(o),0,2*Math.PI,!0),f.fill()},b=function(){f.fillStyle=p?c:a,f.fillText(r.getSecondsLeft(o),r.centrePoint,r.centrePoint)},x=150,P=function(){var e=r.getExplosionRadius(o),t=r.getOuterBoundaryRadius(o),n=Math.max(e-x,0),i=Math.min(e,t);if(n<=t){var a=f.createRadialGradient(r.centrePoint,r.centrePoint,i,r.centrePoint,r.centrePoint,n);a.addColorStop(1,"transparent"),a.addColorStop(0,"#aaa"),f.fillStyle=a,f.beginPath(),f.arc(r.centrePoint,r.centrePoint,i,0,2*Math.PI,!0),f.arc(r.centrePoint,r.centrePoint,n,0,2*Math.PI,!1),f.closePath(),f.fill()}},k=function(e,t,n,o){void 0!==o&&(m.fillStyle=o),m.beginPath(),m.arc(e,t,n,0,2*Math.PI,!0),m.closePath(),m.fill()},E=r.playerRadius+1,B=function(){h.width=4*E*t,h.height=2*E*t,k(E,E,E-1,c),k(3*E,E,E-1,a)},L=function(e,t,n,o){var i;o?(i=0,f.fillStyle=c):(i=2*E,f.fillStyle=a),f.drawImage(h,i,0,2*E,2*E,e-E,t-E,2*E,2*E),f.fillText(n,e,t-32)},M=document.getElementById("myName"),I=document.getElementById("me");return i.showMe=function(e){M.innerHTML=e.name,I.className=""},i.hideMe=function(){I.className="hidden"},i.resize=function(e){var n=window.devicePixelRatio||1,o=f.webkitBackingStorePixelRatio||f.mozBackingStorePixelRatio||f.msBackingStorePixelRatio||f.oBackingStorePixelRatio||f.backingStorePixelRatio||1,i=window.innerWidth,r=window.innerHeight;t=n/o,l.width=i*t,l.height=r*t,l.style.width=i+"px",l.style.height=r+"px",B(),w.centreX=i/2,w.centreY=r/2,e()},i.swapColours=function(){p=!p;var e=p?a:c;document.body.style.backgroundColor=e},i.setView=function(e){w.left=e.x-w.centreX,w.top=e.y-w.centreY,w.right=e.x+w.centreX,w.bottom=e.y+w.centreY},i}},function(e,t,n){e.exports=function(){var e,t,o,i={},r=n(4)("canvas"),a=n(2)(),c=n(1)(),d={name:void 0,id:void 0},s=[],u="";return i.init=function(){a.bindPlayButton(i.play),a.bindWindowResize(r.resize,function(){e?r.currentFrame(s,d):r.reset()})},i.play=function(){var e=/^\w*$/,t=document.getElementById("nameInput").value;e.test(t)?(d.name=t||"anon",i.server.connect()):a.showStartMessage("nickname can only have numbers and letters")},i.server={connect:function(){try{t=io("http://circles-nerdycouple.rhcloud.com:8000",{reconnection:!1}),a.showStartMessage("connecting..."),t.on("connect",function(){a.showStartMessage("connected"),d.id="/#"+t.id,t.emit("nick",d)}),t.on("ready",function(){i.start()}),t.on("update",function(e,t){s=e,r.setTime(t),i.setViewAndPlayer()}),t.on("endRound",function(e){a.updateLeaderboard(e),r.swapColours()}),t.on("kick",function(e){u=e}),t.on("ping",function(e){t.emit("pong",e)}),t.on("disconnect",function(){i.end()})}catch(e){e instanceof ReferenceError?a.showStartMessage("server is down :("):a.showStartMessage("I have no idea what went wrong ¯\\_(ツ)_/¯")}},update:function(e){t.emit("update",e)}},i.physics=function(){var e,t,n=window.performance.now(),i=n-o;e=i/c.tickLength;for(var a=0;a<s.length;a++)t=s[a],t.pos.x+=t.vel.x*e,t.pos.y+=t.vel.y*e,t.id===d.id&&(d.x=t.pos.x,d.y=t.pos.y);r.setView(d),r.incTime(e),o=n},i.start=function(){var t=function(){r.currentFrame(s,d),i.physics(),setTimeout(function(){e=window.requestAnimationFrame(t)},0)};a.setup(i.server.update),o=window.performance.now(),r.showMe(d),t()},i.end=function(){window.cancelAnimationFrame(e),r.reset(),a.reset(u)},i.setViewAndPlayer=function(){var e=s.find(function(e){return e.id===d.id});null!=e&&(d.x=e.pos.x,d.y=e.pos.y,r.setView(d))},i}},function(e,t){}]);